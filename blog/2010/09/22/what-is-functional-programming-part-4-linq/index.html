
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>What is Functional Programming? Part 4, Linq - Christopher Bennage</title>
  <meta name="author" content="Christopher Bennage">

  
  <meta name="description" content="If you are new to this series, start here. Before I move on to the two remaining items on my list (pattern matching and memoization), I’d like to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dev.bennage.com/blog/2010/09/22/what-is-functional-programming-part-4-linq/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ChristopherBennage" rel="alternate" title="Christopher Bennage" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26126539-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Christopher Bennage</a></h1>
  
    <h2>not all who wander are lost</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ChristopherBennage" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dev.bennage.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">What Is Functional Programming? Part 4, Linq</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-22T07:30:00-07:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>If you are new to this series, <a href="/blog/2010/09/06/what-is-functional-programming">start here</a>.</p>


<p>  <p>Before I move on to the two remaining items on my list (pattern matching and memoization), I’d like to take a brief excursion and talk about about Linq in C#. I never said it explicitly, but I have been writing this series for C# developers. I do plan to show you more F#, but while reading the aforementioned <a href="http://www.amazon.com/gp/product/1933988924?ie=UTF8&amp;tag=bluspiconinc-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1933988924" target="_blank">Real World Functional Programming</a> I found it very helpful to first learn these concepts in a familiar language.</p>  <h3>Linq is Functional</h3>  <p>You might have heard it mentioned that Linq was born from the influence of functional languages. Let’s take a moment and connect some dots.</p>  <p>It <a title="regarding recursion" href="/blog/2010/09/14/what-is-functional-programming-part-3-recursion">the last post</a>, I gave you a functional version of our Reduce function. However, both the <a href="http://gist.github.com/575854" target="_blank">imperative version</a> and the <a href="http://gist.github.com/575857" target="_blank">functional version</a> were tied to working just with integers.</p>  <p>Now you might have notice that these specific implementations can be abstracted into the concept of <em>reducing a list of items of a certain type to a single item of the same time</em>.</p>  <p>Starting with our imperative version, we just need to replace all of the <em>int</em>s with a generic type parameter:</p>  <pre class="c#:nogutter:nocontrols" name="code">// generic imperative version
static T Reduce&lt;T&gt;(Func&lt;T, T, T&gt; reducer, IEnumerable&lt;T&gt; values)
{</p>

<pre><code>T accum = default(T);
foreach (var i in values)
{
    accum = reducer(accum, i);
}
return accum;
</code></pre>

<p>}</pre>
Well, we’d also have to initialize the <em>accum</em> variable a bit differently.</p>

<p>A generic version of the functional one is </p>




<pre class="c#:nogutter:nocontrols" name="code">static T ReduceF&lt;T&gt;(Func&lt;T, T, T&gt; reducer, IEnumerable&lt;T&gt; values, T seed)
{
    if (!values.Any()) return seed;

    var first = values.First();
    var remainder = values.Skip(1);
    var next = reducer(seed, first);

    return ReduceF(reducer, remainder, next);
}</pre>




<p>or even better</p>




<pre class="c#:nogutter:nocontrols" name="code">static T ReduceF(Func&lt;T, T, T&gt; reducer, IEnumerable&lt;T&gt; values, T seed)   
{   
    return values.Any()    
        ? ReduceF(reducer, values.Skip(1), reducer(seed, values.First()))    
        : seed;   
}  </pre>




<p>Now, in C# would could save even more typing by implementing our Reduce using Linq</p>




<pre class="c#:nogutter:nocontrols" name="code">static T ReduceLinq&lt;T&gt;(Func&lt;T, T, T&gt; reducer, IEnumerable&lt;T&gt; values)
{
    return values.Aggregate(default(T), reducer);
}</pre>




<p>Of course, after we do, we realize that our Reduce function <em>is the same as</em> the Aggregate extension method that already exists in Linq!</p>




<p>You see, if you are using Linq then you are already utilizing functional language concepts.</p>




<p><em><strong>N.B.</strong> The implementations of ReduceF are not something that you’d want to use in practice. Even though I followed a </em><a href="http://en.wikipedia.org/wiki/Tail_call" target="_blank"><em>tail call</em></a><em> style for the recursion, you’d still end up with a stack overflow in C#.</em></p>




<h4>Removing the Extra Parameter</h4>




<p>Of course, the <a href="http://gist.github.com/575857" target="_blank">functional version</a> <em>ReduceF</em> still has that extra parameter that we named <em>seed</em>. We’d like to get rid of that. </p>




<p>The approach that I have frequently seen, is to wrap the recursion function in another function that provides the initial state. In other words, we’d leave ReduceF as it is (though we’d likely make it private) and then we’d add a new function that looked like this:</p>




<pre class="c#:nogutter:nocontrols" name="code">static T ReducePublic&lt;T&gt;(Func&lt;T, T, T&gt; reducer, IEnumerable&lt;T&gt; values)
{
    return ReduceF&lt;T&gt;(reducer, values, default(T));
}</pre>




<h3></h3>




<p><em>Update: there is some good discussion about removing the extra parameter in the </em><a href="/blog/2010/09/14/what-is-functional-programming-part-3-recursion/"><em>comments of part 3</em></a><em>. As mentioned there, the primary reason for doing it this way is an academic desire to preserve the tail call form.</em></p>




<p>In our <a href="/blog/2010/10/05/what-is-functional-programming-part-5-bindings/">next post</a>, we’ll start digging a little deeper into F#.</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Christopher Bennage</span></span>

      








  


<time datetime="2010-09-22T07:30:00-07:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/f-/'>F#</a>, <a class='category' href='/blog/categories/functional-programming/'>functional programming</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://dev.bennage.com/blog/2010/09/22/what-is-functional-programming-part-4-linq/" data-via="bennage" data-counturl="http://dev.bennage.com/blog/2010/09/22/what-is-functional-programming-part-4-linq/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/09/14/what-is-functional-programming-part-3-recursion/" title="Previous Post: What is Functional Programming? Part 3, Recursion">&laquo; What is Functional Programming? Part 3, Recursion</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/10/05/what-is-functional-programming-part-5-bindings/" title="Next Post: What is Functional Programming? Part 5, Bindings">What is Functional Programming? Part 5, Bindings &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
<h1>About Christopher</h1>

<img class="bio" src="http://gravatar.com/avatar/0128fa0de6a321d6e3766ae3fa06b9c2?s=80">

<ul><li>
<p>
Christopher is a developer on the <a href="http://msdn.microsoft.com/practices">patterns & practices</a> team at Microsoft.
</p>


<p>
He considers sidewalks to merely be suggestions and frequently falls under the influence of G. K. Chesterton.
</p><p>
He thinks agile software principles and open source software are pretty cool; especially if JavaScript is involved.
</p>
</li>
</ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/05/20/game-dev-03b/">Couple of JavaScript Questions</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/05/game-dev-03/">Building a Game with JavaScript: Making Things Move</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/11/game-dev-02/">Building a Game with JavaScript: Start Screen</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/07/game-dev-01/">Building a Game with JavaScript</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/07/a-n00bs-look-at-html5-game-development/">a n00b's look at HTML5 game development</a>
      </li>
    
  </ul>
</section>
<section>
<div id="recentcomments" class="dsq-widget">
<h1 class="dsq-widget-title">Recent Comments</h1>
<script type="text/javascript" src="http://bennage.disqus.com/recent_comments_widget.js?num_items=&hide_avatars=1&avatar_size=18&excerpt_length="></script>
</div>
</section>
<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("bennage", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/bennage" class="twitter-follow-button" data-show-count="false">Follow @bennage</a>
  
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/bennage">@bennage</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'bennage',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Christopher Bennage -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/javascripts/bennage.js"></script>
<script src="/javascripts/newhope.js"></script>

</body>
</html>
